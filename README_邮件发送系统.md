# 📧 每日学习计划自动邮件发送系统

## 📋 功能介绍

这是一个智能的每日学习计划发送系统，能够：

✅ 自动识别当前日期对应的学习任务  
✅ 将Markdown格式的学习计划转换为Word文档  
✅ 定时发送到指定邮箱  
✅ 支持自定义发送时间  
✅ 完整的日志记录  

---

## 🚀 快速开始

### 1️⃣ 安装依赖

在命令行中运行：

```bash
pip install -r requirements.txt
```

或者直接运行：

```bash
pip install python-docx schedule
```

---

### 2️⃣ 首次使用 - 测试发送

运行程序：

```bash
python daily_study_mailer.py
```

然后选择 **选项1：立即测试发送**

这会立即发送今天的学习计划到您的邮箱，用于测试邮件系统是否正常工作。

---

### 3️⃣ 启动定时发送

测试成功后，再次运行程序：

```bash
python daily_study_mailer.py
```

选择 **选项2：启动定时发送**

程序将在后台运行，每天早上8点自动发送学习计划。

---

## ⚙️ 配置说明

### 邮箱配置

程序已配置好您的邮箱信息：

- **发件邮箱**: xingyun1982314@126.com
- **收件邮箱**: xingyun1982314@126.com
- **SMTP服务器**: smtp.126.com
- **端口**: 465（SSL加密）

> ⚠️ **注意**: 密码 `MKYurXXfTuE9uZ4p` 是您的126邮箱授权码，不是登录密码！

---

### 学习计划起始日期

- **Day 1 对应日期**: 2026年1月29日
- **自动计算**: 程序会根据当前日期自动计算是第几天
- **支持范围**: 目前支持第1-7天（第一周）

---

## 📁 文件结构

```
D:\0.py\ai\document\
│
├── daily_study_mailer.py          # 主程序
├── requirements.txt               # 依赖包列表
├── README_邮件发送系统.md          # 使用说明（本文件）
├── study_mailer.log              # 运行日志（自动生成）
│
├── DailyTasks\                   # 学习任务文件夹
│   ├── Day1_第1天学习任务_1月29日.md
│   ├── Day2_第2天学习任务_1月30日.md
│   ├── Day3_第3天学习任务_1月31日.md
│   ├── Day4_第4天学习任务_2月1日.md
│   ├── Day5_第5天学习任务_2月2日.md
│   ├── Day6_第6天学习任务_2月3日.md
│   └── Day7_第7天学习任务_2月4日.md
│
└── output_docs\                  # Word文档输出目录（自动生成）
    └── 学习任务_2026年01月29日.docx
```

---

## 🎯 使用场景

### 场景1：每天早上自动提醒

```bash
python daily_study_mailer.py
# 选择 2 - 启动定时发送（每天8:00）
```

程序会在后台运行，每天早上8点自动发送当天的学习计划。

---

### 场景2：自定义发送时间

```bash
python daily_study_mailer.py
# 选择 3 - 自定义发送时间
# 输入时间，如：07:30 或 20:00
```

---

### 场景3：立即发送测试

```bash
python daily_study_mailer.py
# 选择 1 - 立即测试发送
```

不等待定时，立即发送当天的学习计划，用于测试。

---

## 📝 日志文件

程序运行时会自动生成 `study_mailer.log` 日志文件，记录所有操作：

```
2026-01-29 08:00:01 - INFO - 开始执行每日学习计划发送任务
2026-01-29 08:00:02 - INFO - 找到今天的学习任务文件: Day1_第1天学习任务_1月29日.md
2026-01-29 08:00:03 - INFO - 开始转换文件: Day1_第1天学习任务_1月29日.md
2026-01-29 08:00:05 - INFO - Word文档已保存: output_docs\学习任务_2026年01月29日.docx
2026-01-29 08:00:06 - INFO - 附件已添加: 学习任务_2026年01月29日.docx
2026-01-29 08:00:08 - INFO - ✅ 邮件发送成功！
```

---

## ⚠️ 常见问题

### Q1: 提示"未找到学习任务文件"？

**A:** 检查以下几点：
1. 确认 `DailyTasks` 文件夹存在
2. 确认今天的日期对应的文件存在
3. 检查文件名是否正确

---

### Q2: 邮件发送失败？

**A:** 可能的原因：
1. ❌ 网络连接问题 → 检查网络
2. ❌ 授权码错误 → 确认授权码是否正确
3. ❌ SMTP服务未开启 → 登录126邮箱，开启SMTP服务

**126邮箱SMTP开启方法：**
1. 登录 mail.126.com
2. 设置 → POP3/SMTP/IMAP
3. 开启"POP3/SMTP服务"或"IMAP/SMTP服务"
4. 获取授权码（不是登录密码！）

---

### Q3: 如何修改邮箱配置？

**A:** 编辑 `daily_study_mailer.py` 文件，找到这部分：

```python
EMAIL_CONFIG = {
    'sender_email': 'xingyun1982314@126.com',
    'sender_password': 'MKYurXXfTuE9uZ4p',
    'receiver_email': 'xingyun1982314@126.com',
    'smtp_server': 'smtp.126.com',
    'smtp_port': 465
}
```

修改对应的值即可。

---

### Q4: 程序在后台运行吗？

**A:** 
- ✅ 在Windows上：程序会占用一个命令行窗口，需要保持窗口打开
- ✅ 建议使用Windows任务计划程序或在服务器上运行
- ✅ 可以最小化窗口，但不要关闭

---

### Q5: 如何让程序开机自动启动？

**A:** 两种方法：

**方法1：创建快捷方式到启动文件夹**
1. 右键 `daily_study_mailer.py` → 创建快捷方式
2. Win+R 输入 `shell:startup` 打开启动文件夹
3. 将快捷方式复制到启动文件夹

**方法2：使用Windows任务计划程序**
1. 打开"任务计划程序"
2. 创建基本任务
3. 触发器：系统启动时
4. 操作：启动程序 `python D:\0.py\ai\document\daily_study_mailer.py`

---

## 🔧 高级功能

### 修改发送时间

直接在代码中修改或使用选项3自定义。

### 添加更多收件人

修改 `EMAIL_CONFIG` 中的 `receiver_email`，多个邮箱用逗号分隔。

### 自定义邮件内容

修改 `send_today_study_plan()` 函数中的 `body` 变量。

---

## 📊 系统要求

- **Python版本**: Python 3.6+
- **操作系统**: Windows / Linux / macOS
- **网络**: 需要能够连接到SMTP服务器
- **依赖包**: python-docx, schedule

---

## 💡 使用建议

1. ✅ **首次使用先测试**: 选择"立即测试发送"，确保邮件系统工作正常
2. ✅ **检查垃圾邮件**: 首次收到邮件可能在垃圾箱，设置为"非垃圾邮件"
3. ✅ **定期查看日志**: 检查 `study_mailer.log` 了解运行状态
4. ✅ **保持程序运行**: 定时任务需要程序持续运行才能生效
5. ✅ **备份配置**: 修改配置前先备份原文件

---

## 🎉 开始使用

现在就运行程序，开启您的高效学习之旅吧！

```bash
python daily_study_mailer.py
```

**祝学习顺利！💪📚**

---

## 📞 技术支持

如有问题，请查看：
1. 日志文件 `study_mailer.log`
2. 本README的"常见问题"部分
3. 检查邮箱配置是否正确

---

**版本**: v1.0  
**最后更新**: 2026-01-28

